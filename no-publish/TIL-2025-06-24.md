---
title: TIL (Process Isolation)
published: true
description: TIL; Why do we need process isolation ?!
tags: '#isolation,#docker,#kubernetes'
---

Containers build on a rich history of technologies designed to isolate one computer program from another while allowing many programs to share the same CPU, memory, storage, and network resources.

## Why Processes Need Isolation

Running programs simultaneously, needs sharing computers resources.
as soon as something needs to be shared, there is a need to make sure it is shared fairly, and computer programs are no different.  So al­though we think of a process as an independent program with its own time on the CPU and its own memory space, there are many ways that one pro­cess can cause trouble for another, including:

- Using too much CPU, memory, storage, or network
- Overwriting the memory or files of another process
- Extracting secret information from another process
- Sending another process bad data to cause it to misbehave
- Flooding another process with requests so that it stops responding

But a big­ger concern is a security vulnerability that allows a bad actor to use one pro­cess to cause problems for another, so we need ways to isolate processes that limit damage from both accidental and intentional behavior.

- Physical isolation (air­gapped) systems: this approach is also too expensive and inconvenient for many uses
- Virtual Machines: overhead of running its own operating system, services, and virtual devices, making it slower to start and less scalable.

The solution is to run regular processes, but use process isolation to reduce the risk of affecting other processes.

- Basic isolation in linux
  - File Permissions
  - Change Root `chroot`
  - Jail
  - Container Isolation

### File Permissions and Change Root

Most of the effort in process isolation involves preventing one process from seeing things it shouldn’t. One of the most basic visibility controls is filesystem permissions. This basic permission scheme works well to ensure that user files are kept private, that a process cannot overwrite the files of another process, and that only a privileged user like root can install new software or modify critical system configuration files. Permission control is important, but it doesn’t fully satisfy our goal of process isolation. One reason is that it is not enough to protect us from privilege escalation, wherein a vulnerable process and a vulnerable system allow a bad actor to obtain root privileges.

To help deal with this, some Linux services go a step beyond by running in an isolated part of the filesystem. This approach is known as `chroot` for "change root."

### Container Isolation

File permissions and change root are basic­level knowledge. However, those concepts also serve as the foundation for how containers work. Even though a running container ap­pears like a completely separate system, with its own hostname, network, processes, and filesystem (as we saw in Chapter 1), it’s really a regular Linux process using isolation rather than a virtual machine.

A container has multiple kinds of isolation (namespace):

- Mounted filesystems (`mnt` namespace)
- Hostname and domain name (`uts` namespace)
- Inter Process communication (`ipc` namespace)
- Process identifiers (`pid` namespace)
- Network devices (`net` namespace)

These separate kinds of isolation work together so that a process or collection of processes looks like a completely separate system.

***Container Platforms and Container Runtimes***

Docker is an example of a container platform, providing not only the ability to run containers but also container storage, networking, and security. Under the covers, modern versions of Docker are using `containerd` as the container runtime, also known as a container engine. A container runtime
provides low­level functionality to run processes in containers.

Container runtimes are low­level libraries. They are typically not used directly but are used by a higher­level container platform or orchestration environment such as Docker or Kubernetes.

### Linux Namespaces

Like other container runtimes, containerd uses a Linux kernel feature called namespaces to isolate the processes in the container As mentioned earlier, most of the effort in process isolation is to ensure that a process can’t see things it shouldn’t. A process running in a namespace sees a limited view of a particular system resource. We can find out what namespaces are associated with
our container using the `lsns` command.

- `mnt` Mount points
- `uts` Unix time sharing (hostname and network domain)
- `ipc` Inter process communication (for example, shared memory)
- `pid` Process identifiers (and list of running processes)
- `net` Network (including interfaces, routing table, and firewall)

[the-book-of-kubernetes-ch02]: https://google.com
[Linux-namespaces]: https://google.com
